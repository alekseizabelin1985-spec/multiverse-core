# üì° –°–æ–±—ã—Ç–∏–π–Ω–∞—è –º–æ–¥–µ–ª—å

> **–°–æ–±—ã—Ç–∏—è ‚Äî —Ñ–∞–∫—Ç—ã, –∞ –Ω–µ –∫–æ–º–∞–Ω–¥—ã. –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –¥–ª—è replay.**

## üìÅ –¢–æ–ø–∏–∫–∏ Kafka

| –¢–æ–ø–∏–∫ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | Consumer Groups |
|-------|-----------|----------------|
| `player_events` | –î–µ–π—Å—Ç–≤–∏—è –∏–≥—Ä–æ–∫–æ–≤ | `ban-of-world`, `semantic-memory` |
| `world_events` | –†–µ–∞–∫—Ü–∏—è –º–∏—Ä–∞ | `gm_world_*`, `reality_monitor`, `semantic-memory` |
| `game_events` | –ò–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ | `city_governor`, –∫–ª–∏–µ–Ω—Ç, `semantic-memory` |
| `system_events` | –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è | `entity_manager`, `world_generator`, `semantic-memory` |
| `scope_management` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–ª–∞—Å—Ç—è–º–∏ GM | `narrative-orchestrator`, `semantic-memory` |
| `narrative_output` | –í—ã—Ö–æ–¥–Ω–æ–µ –ø–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ | –∫–ª–∏–µ–Ω—Ç, `semantic-memory` |

## üì¶ –§–æ—Ä–º–∞—Ç —Å–æ–±—ã—Ç–∏—è

```json
{
  "event_id": "uuid4",
  "event_type": "player.used_skill",
  "timestamp": "2025-10-28T12:00:00Z",
  "source": "player-777",
  "world_id": "pain-realm",
  "scope_id": "city-ashes",
  "payload": {
    "spell_id": "fireball",
    "state_changes": [ ... ],
    "entity_snapshots": [ ... ],
    "description": "–í—ã –≤—ã–ø—É—Å—Ç–∏–ª–∏ –æ–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä..."
  }
}
```

## üîë –ü—Ä–∏–Ω—Ü–∏–ø—ã —Å–æ–±—ã—Ç–∏–π
- **–°–æ–±—ã—Ç–∏—è ‚Äî —Ñ–∞–∫—Ç—ã, –∞ –Ω–µ –∫–æ–º–∞–Ω–¥—ã**
"–∏–≥—Ä–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —É–º–µ–Ω–∏–µ" –≤–º–µ—Å—Ç–æ "–∑–∞–±–ª–æ–∫–∏—Ä—É–π —É–º–µ–Ω–∏–µ".
- **–ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è**
–í—Å–µ —Å–æ–±—ã—Ç–∏—è —Ö—Ä–∞–Ω—è—Ç—Å—è —Å –¥–æ–ª–≥–∏–º retention –¥–ª—è replay.
- **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è**
–ò–µ—Ä–∞—Ä—Ö–∏—è —Ç–∏–ø–æ–≤: player.action.*, world.metric.*, violation.*.
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç –≤ —Å–æ–±—ã—Ç–∏–∏**
–ö–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏.
- **UTF-8 –∫–æ–¥–∏—Ä–æ–≤–∫–∞**
–í—Å–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è –≤ UTF-8 —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞.

## üóÉÔ∏è –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π

–í—Å–µ —Å–æ–±—ã—Ç–∏—è —Å–∏—Å—Ç–µ–º—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å–µ—Ä–≤–∏—Å–æ–º SemanticMemory –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ.
–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–æ–±—ã—Ç–∏–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–≥—Ä–æ–≤—É—é —Å–∏—Ç—É–∞—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏
- –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å —Å–æ–±—ã—Ç–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—É—é –ø–∞–º—è—Ç—å —Å–∏—Å—Ç–µ–º—ã
- –ò–∑–≤–ª–µ–∫–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –ø–æ —Ç–∏–ø—É –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞